<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Bastumbas</title>
  <style>
    * { box-sizing: border-box; margin:0; padding:0; }
    body { font-family: Arial, sans-serif; background:#fff; }

    /* ===== HEADER ===== */
    header {
      position: fixed; top:0; left:0; right:0;
      height:60px; background:#2f2f2f; color:#fff;
      display:flex; align-items:center; justify-content:space-between;
      padding:0 20px; z-index:1000;
    }
    .cart-icon { position:relative; font-size:22px; cursor:pointer; }
    .cart-badge {
      position:absolute; top:-8px; right:-10px;
      background:red; color:white; border-radius:50%;
      font-size:12px; padding:2px 6px;
    }

    /* ===== MAIN ===== */
    .main-wrapper { display:flex; margin-top:65px; }
    .main-content { flex:1; padding:15px; }
    .product-grid {
      display:grid; grid-template-columns:repeat(auto-fill,minmax(180px,1fr));
      gap:20px;
    }

    /* ===== PRODUK ===== */
    .product-card {
      background:#f9f9f9; border-radius:6px; padding:10px;
      box-shadow:0 2px 5px rgba(0,0,0,0.1);
      display:flex; flex-direction:column; gap:5px;
      cursor:pointer;
    }

    /* ===== SLIDER ===== */
    .slider {
      position:relative; height:150px;
      background:#ccc; border-radius:6px; overflow:hidden;
    }
    .slide {
      display:none; width:100%; height:100%;
      background:#999; color:#fff; font-size:40px;
      display:flex; align-items:center; justify-content:center;
    }
    .slide.active { display:flex; }
    .panah {
      position:absolute; top:50%; transform:translateY(-50%);
      background:rgba(0,0,0,0.3); color:#fff;
      border:none; border-radius:4px;
      font-size:18px; padding:5px 10px;
      cursor:pointer; opacity:0; pointer-events:none;
      transition:0.3s;
    }
    .slider:hover .panah { opacity:1; pointer-events:auto; }
    .panah.prev { left:5px; } .panah.next { right:5px; }

    /* ===== POPUP ===== */
    .popup {
      position:fixed; top:0; left:0; right:0; bottom:0;
      background:rgba(0,0,0,0.6);
      display:none; align-items:center; justify-content:center;
      z-index:2000;
    }
    .popup-content {
      position:relative;
      background:#fff; padding:20px; border-radius:8px;
      width:90%; max-width:400px; max-height:90vh;
      display:flex; flex-direction:column; overflow:hidden;
    }
    .popup-content .slider { aspect-ratio:1/1; height:auto; }
    .popup-close {
      position:absolute; top:10px; right:15px;
      font-size:22px; font-weight:bold; color:#666; cursor:pointer;
    }
    .popup-description {
      margin-top:15px; font-size:14px; line-height:1.4;
      overflow-y:auto; max-height:150px;
    }

    /* ===== RESPONSIVE HP ===== */
    @media(max-width:768px){
      .product-grid{ grid-template-columns:repeat(2,1fr); }
      .slider{ height:120px; }
      .slider button{ display:block !important; opacity:0.5 !important; pointer-events:auto !important; }
    }
  </style>
</head>
<body>
<header>
  <div>Bastumbas</div>
  <div class="cart-icon">ðŸ›’<span class="cart-badge" id="cart-count">0</span></div>
</header>

<div class="main-wrapper">
  <div class="main-content">
    <div class="product-grid" id="product-grid"></div>
  </div>
</div>

<!-- POPUP -->
<div class="popup" id="popup">
  <div class="popup-content">
    <span class="popup-close" onclick="tutupPopup()">Ã—</span>
    <div class="slider" id="popup-slider"></div>
    <div id="popup-desc" class="popup-description"></div>
  </div>
</div>

<script>
/* ===== DATA KERANJANG ===== */
let cart=0;
function tambahKeranjang(){ document.getElementById("cart-count").innerText=++cart; }

/* ===== GENERATE PRODUK ===== */
function buatProduk(i){
  const jumlah=Math.floor(Math.random()*3)+1; // 1-3 gambar
  let slides="";
  for(let j=1;j<=jumlah;j++){
    slides+=`<div class="slide ${j===1?'active':''}" data-index="${j}">G${j}</div>`;
  }
  return `
    <div class="product-card" data-id="${i}" data-jumlah="${jumlah}">
      <div class="slider" data-jumlah="${jumlah}" data-pos="1">
        ${slides}
        <button class="panah prev" onclick="pindahSlide(event,this,-1)">&lt;</button>
        <button class="panah next" ${jumlah>1?'':'style="display:none;"'} onclick="pindahSlide(event,this,1)">&gt;</button>
      </div>
      <div>Produk ${i}</div>
      <button onclick="event.stopPropagation();tambahKeranjang()">Tambah ke Keranjang</button>
    </div>`;
}
document.getElementById("product-grid").innerHTML=
  Array.from({length:8},(_,i)=>buatProduk(i+1)).join("");

/* ===== EVENT KLIK PRODUK BUKA POPUP ===== */
document.querySelectorAll(".product-card").forEach(card=>{
  card.addEventListener("click",()=>{
    const jumlah=card.dataset.jumlah;
    const pos=card.querySelector(".slider").dataset.pos;
    bukaPopup(card.dataset.id,jumlah,pos);
  });
});

/* ===== SLIDER FUNCTION ===== */
function pindahSlide(e,btn,arah){
  e.stopPropagation();
  const slider=btn.closest(".slider");
  const jumlah=parseInt(slider.dataset.jumlah);
  let pos=parseInt(slider.dataset.pos);
  const slides=slider.querySelectorAll(".slide");
  slides[pos-1].classList.remove("active");
  pos+=arah;
  if(pos<1) pos=1; if(pos>jumlah) pos=jumlah;
  slides[pos-1].classList.add("active");
  slider.dataset.pos=pos;
}

/* ===== POPUP FUNCTION ===== */
function bukaPopup(id,jumlah,pos){
  const slider=document.getElementById("popup-slider");
  let html="";
  for(let j=1;j<=jumlah;j++){
    html+=`<div class="slide ${j==pos?'active':''}" data-index="${j}">G${j}</div>`;
  }
  slider.innerHTML=html+`
    <button class="panah prev" onclick="pindahSlide(event,this,-1)">&lt;</button>
    <button class="panah next" ${jumlah>1?'':'style="display:none;"'} onclick="pindahSlide(event,this,1)">&gt;</button>`;
  slider.dataset.jumlah=jumlah; slider.dataset.pos=pos;
  document.getElementById("popup-desc").innerText="Deskripsi Produk "+id+" yang panjang supaya bisa discroll di sini...";
  document.getElementById("popup").style.display="flex";
}
function tutupPopup(){ document.getElementById("popup").style.display="none"; }

/* ===== TUTUP POPUP KLIK AREA GELAP ===== */
document.getElementById("popup").addEventListener("click",e=>{
  if(e.target.id==="popup") tutupPopup();
});

/* ===== SWIPE UNTUK SLIDER HP ===== */
function enableSwipe(slider){
  let startX=0;
  slider.addEventListener("touchstart",e=> startX=e.touches[0].clientX );
  slider.addEventListener("touchend",e=>{
    let dx=e.changedTouches[0].clientX-startX;
    if(dx>50) pindahSlide(e,slider.querySelector(".prev"),-1);
    else if(dx<-50) pindahSlide(e,slider.querySelector(".next"),1);
  });
}
document.querySelectorAll(".slider").forEach(s=>enableSwipe(s));
</script>
</body>
</html>
